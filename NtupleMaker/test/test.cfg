# -*-sh-*-
process B  = {

  service = Timing {}


 untracked PSet maxEvents = {untracked int32 input = 100}
  untracked PSet options =
  {
    untracked vstring Rethrow = {"ProductNotFound"}
  }
             
  source = PoolSource
  {
#    untracked vstring fileNames = {'/store/CSA07/2008/1/11/CSA07-CSA07Muon-Gumbo-B1-PDMuon-ReReco-100pb/0003/0ABB821B-07C1-DC11-BA0F-001BFCDBD182.root'}
    #untracked vstring fileNames = {'dcache:/pnfs/cms/WAX/8/cms1/DiLepton/samples/CMSSW_1_5_3/TTbar_leptonic/reco_0.root'}
   #untracked vstring fileNames = {'/store/CSA07/skim/2008/2/20/CSA07-CSA07Electron-Chowder-A1-PDElectron-ReReco-startup-Skims6/0002/66CDAB79-0BE0-DC11-8DAA-001617E30D40.root'}
   untracked vstring fileNames = {'file:/uscms_data/d1/kalavase/CMS1/CMSSW_1_6_12/src/CSA07ChowderElectron.root'}   
# untracked vstring fileNames = {'/store/mc/2007/11/1/CSA07-DYmumu_M2000-1193937007/0012/04915747-5994-DC11-9CA9-0018F3D0963C.root'}
    #untracked vstring fileNames = {'file:04915747-5994-DC11-9CA9-0018F3D0963C.root'}
    untracked uint32 skipEvents = 0
  }

  include "CMS1/NtupleMaker/data/ntupleMaker.cff"

 module tqntupleMaker = NtupleMakerFW {
      using tqNtupleMakerCommonBlock
  }

 module ntupleMaker = NtupleMakerFW {
    using NtupleMakerCommonBlock
 }

 #used only for the CSA07 soups!!!!!
 module csa07EventWeightProducer = CSA07EventWeightProducer {
    InputTag src = source
    untracked bool talkToMe = true 
    double overallLumi = 1000.
    double ttKfactor = 1.
  }

 sequence JetCorrection = {
    MCJetCorrections,
    JetCorrectionsExtra
}

#required for 167 and earlier files
sequence genP= {genParticles}

sequence tq = {
    tqafHighLevelReco,
    allLayer1TopElectrons,
    allLayer1TopMuons,
    allLayer1TopTaus,
    allLayer1TopJets,
    allLayer1TopMETs
}
	
 
  #if using the tq layer objects 
  replace tqntupleMaker.haveTriggerInfo = true 
  replace tqntupleMaker.csa07_soup = false
  replace tqntupleMaker.writeL1Particles = true 
  replace tqntupleMaker.genJetType = "midPointCone5GenJetsPt10"
  replace tqntupleMaker.fileName = "cms2_ntuple_tq.root"
  replace tqntupleMaker.candidateBasedNtuples = false

  #if not using the tq layer objects 
  replace ntupleMaker.haveTriggerInfo = false 
  replace ntupleMaker.csa07_soup = false
  replace ntupleMaker.writeL1Particles = false
  replace ntupleMaker.genJetType = "midPointCone5GenJetsPt10"
  replace ntupleMaker.fileName = "cms2_ntuple_nottq.root"

  module ecalClusters = EcalClusterProducer {}

  module l1DigiMaker  = L1DigiMaker {} 

  include "CMS2/NtupleMaker/data/eventMaker.cfi"
  include "CMS2/NtupleMaker/data/jetMaker.cfi"
  include "CMS2/NtupleMaker/data/jetToMuAssMaker.cfi"
  include "CMS2/NtupleMaker/data/jetToElAssMaker.cfi"
  include "CMS2/NtupleMaker/data/tqJetMaker.cfi"    
  include "CMS2/NtupleMaker/data/electronMaker.cfi"
  include "CMS2/NtupleMaker/data/tqElectronMaker.cfi" 
  include "CMS2/NtupleMaker/data/hypTrilepMaker.cfi"
  include "CMS2/NtupleMaker/data/metMaker.cfi" 
  include "CMS2/NtupleMaker/data/genMaker.cfi"
  include "CMS2/NtupleMaker/data/muonMaker.cfi"
  include "CMS2/NtupleMaker/data/trackMaker.cfi"
  include "CMS2/NtupleMaker/data/tqMuonMaker.cfi"
  include "CMS2/NtupleMaker/data/muToElsAssMaker.cfi"
  include "CMS2/NtupleMaker/data/muToGenAssMaker.cfi"
  include "CMS2/NtupleMaker/data/muToJetAssMaker.cfi"
  include "CMS2/NtupleMaker/data/muToTrackAssMaker.cfi"
  include "CMS2/NtupleMaker/data/elToTrackAssMaker.cfi"
  include "CMS2/NtupleMaker/data/elToMuAssMaker.cfi"
  

module outMod = PoolOutputModule {
	untracked string fileName = 'cms2_notqaf.root'
	untracked vstring outputCommands = {
        "drop *", 
	"keep *_trackMaker_*_B",
 	"keep *_muonMaker_*_B",
	"keep *_tqMuonMaker_*_B",
        "keep *_electronMaker_*_B",
	"keep *_tqElectronMaker_*_B",
        "keep *_jetMaker_*_B",
        "keep *_tqJetMaker_*_B",
	"keep *_tqElectronMaker_*_B",
        "keep *_jetToMuAssMaker_*_B",
        "keep *_jetToElAssMaker_*_B",
	"keep *_eventMaker_*_B",
	"keep *_metMaker_*_B",
	"keep *_l1DigiMaker_*_B",
        "keep *_genMaker_*_B",
	"keep *_muToElsAssMaker_*_B",
	"keep *_muToGenAssMaker_*_B",
	"keep *_muToJetAssMaker_*_B",
	"keep *_muToTrackAssMaker_*_B",
	"keep *_elToTrackAssMaker_*_B",
	"keep *_elToMuAssMaker_*_B",
        "keep *_hypTrilepMaker_*_B"
        }
  }
  #the path must include the genP and JetCorrection sequences before all others. 
  path p = { genP, 
      	     ecalClusters,
	     csa07EventWeightProducer, 
             JetCorrection, 
             tq, 
	     tqntupleMaker,
	     trackMaker,
             muonMaker, 
             electronMaker, 
             jetMaker,
	     tqMuonMaker,
             tqElectronMaker,
             tqJetMaker,
             jetToMuAssMaker,
             jetToElAssMaker,
             eventMaker,
	     metMaker,
	     l1DigiMaker,
             genMaker,
             hypTrilepMaker,
	     muToElsAssMaker,
	     muToGenAssMaker,
	     muToJetAssMaker,
             muToTrackAssMaker,
	     elToTrackAssMaker,
	     elToMuAssMaker
  }
  endpath outpath = { outMod }
      
}
